---
import BaseLayout from '../../../layouts/BaseLayout.astro';
import BlogCard from '../../../components/blog/BlogCard.astro';
import { getAllTags, getPostsByTag } from '../../../utils/blog';

export async function getStaticPaths() {
  const tags = await getAllTags();
  return tags.map((tag) => ({
    params: { tag: tag.toLowerCase() },
    props: { tag },
  }));
}

const { tag } = Astro.props;
const posts = await getPostsByTag(tag);
---

<BaseLayout
  title={`Posts tagged with "${tag}"`}
  description={`All posts tagged with ${tag}`}
>
  <div class="max-w-4xl mx-auto px-4 py-8">
    <header class="mb-12 text-center">
      <h1 class="text-5xl font-bold mb-4">
        #{tag}
      </h1>
      <p class="text-xl text-base-content/70">
        {posts.length} {posts.length === 1 ? 'post' : 'posts'} with this tag
      </p>
    </header>

    <div class="flex flex-col gap-6 mb-12">
      {posts.map((post) => <BlogCard post={post} />)}
    </div>

    {
      posts.length === 0 && (
        <div class="text-center py-12">
          <p class="text-xl text-base-content/60">
            No posts found with this tag.
          </p>
        </div>
      )
    }
  </div>
</BaseLayout>
